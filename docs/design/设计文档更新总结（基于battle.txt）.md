# 📋 设计文档更新总结（基于 battle.txt）

> 根据 `docs2/battle.txt` 合并整理 `docs/design` 文件夹中的文档，移除矛盾内容

---

## 一、更新概览

### 已更新文档

1. ✅ **First_5_Minutes_Perception_Script.md**
   - 更新战斗段数描述：从 3 段/6 段改为 4 段/6~8 段
   - 补充视觉反馈：超出 4 段红边警报，超出 6 段视野缩小

2. ✅ **Genre_Perception_Anchor_Map.md**
   - 更新结算形态描述：统一为 4~8 段（根据风格流派不同）
   - 移除固定段数描述，改为根据 battle.txt 的灵活段数

3. ✅ **Rhythm_Roguelike_Design_Learning_Curve.md**
   - 更新段数和回合数描述：
     - 每段 1~3 个回合（根据 battle.txt）
     - 每关 4~8 段（根据 battle.txt）
   - 补充提前结束战斗的额外掉落机制

4. ✅ **Rhythm_Roguelike_Boss_Behavior_Scripts.md**
   - 补充 Boss 污染卡池增强机制
   - 补充 Boss 战设计目的和战斗状态

5. ✅ **Auditory_Failure_and_Structure_Collapse_Rules.md**
   - 补充段落强制结束机制（3 回合后）
   - 补充挑战失败条件（8 段后）
   - 补充视觉反馈机制

6. ✅ **Rhythm_Roguelike_Gameplay_Safety_Mechanisms.md**
   - 补充与 battle.txt 的对应关系
   - 补充卡池系统保障、段落推进保障、流派系统保障

7. ✅ **Player_Perception_Progression_List.md**
   - 更新段数描述为 4~8 段
   - 补充提前结束战斗的额外掉落机制
   - 补充高手快速闯关机制

---

## 二、核心设计要点（基于 battle.txt）

### 2.1 战斗结构

- **一局**：特定区域 + 特定难度，包含 10 个关卡
- **一个关卡**：一场战斗 = 创作一首限定条件的歌曲
- **战斗段落**：4~8 段乐曲（根据风格流派不同）
- **段落回合**：每段 1~3 个回合

### 2.2 卡池系统

- **卡池结构**：各音轨 5 张随机卡牌
- **可见性**：每条音轨展示 1 张（可见），其余 4 张背面（信息被加密）
- **卡牌类型**：
  - 节奏牌和贝斯牌（有默认库，可通过冒险和探索收集）
  - 风格牌和流派牌（对新玩家全开放，不需要收集）
  - 音符组合牌 + 音阶牌 + 调性牌（有默认库，可通过冒险和探索收集）

### 2.3 干扰体系统

- **刷新规则**：根据玩家实时卡池刷新
- **刷新逻辑**：卡池里的牌有哪些风格和流派，就会刷出对应风格和流派的干扰
- **干扰效果**：使玩家的每条音轨随机发生变化，偏离本段应该有的节奏、音阶、调性、风格、流派
- **干扰体类型**：可以干扰 1 条或多条音轨，造成 1 种或多种干扰

### 2.4 战斗流程

- **回合选择**：玩家在每条音轨上看到 1~2 张自己卡池里的牌，以及污染卡牌，总共 5~6 张
- **修复机制**：选择正确的卡牌（污染牌也可以是正确的效果），修复音轨
- **修复成功**：消灭对应的干扰体，删除敌人污染池里的卡牌（每条音轨各一张），进入下一个段落
- **修复失败**：进入下一回合，干扰体全部刷新
- **强制结束段落**：3 回合后强制结束段落，保留玩家当前的错误选择，进入下一个段落

### 2.5 流派系统

- **流派纯度**：风格流派越统一，敌人能够造成迷惑的空间越来越小
- **干扰体能力：干扰体的干扰能力是随着玩家卡池净化而减少的
- **高手玩法**：高手可以在风格流派构筑的过程中凭着对音乐的理解直接排除干扰和污染，快速闯关

### 2.6 Boss 战

- **污染增强**：直接污染玩家的卡池（每条音轨增加 1/3 的污染牌）
- **设计目的**：考验玩家是否真的理解自己正在构筑的流派
- **战斗状态**：玩家一般都已经有了成熟的流派和足够的道具

### 2.7 视觉反馈

- **段落目标未达成**：添加动画和引导，让玩家意识刚才发生了什么，接下来要做什么
- **超出 4 段**：战斗画面会出现红边警报
- **超出 6 段**：视野缩小，感受到全方位压迫

### 2.8 奖励机制

- **提前结束战斗**：能提前结束战斗的会有额外掉落
- **战斗失败**：如果玩家在完成 8 段之后还没有成功修复，挑战失败，结束整局

---

## 三、移除的矛盾内容

### 3.1 战斗段数

**矛盾点**：
- 旧文档中描述为固定 3~4 段或 2~3 段
- battle.txt 明确为 4~8 段（根据风格流派不同）

**处理方式**：
- 统一更新为 4~8 段
- 说明根据风格流派不同可以快速结束或需要更多段落

### 3.2 回合数

**矛盾点**：
- 旧文档中描述为固定 2~3 回合
- battle.txt 明确为每段 1~3 个回合

**处理方式**：
- 统一更新为每段 1~3 个回合
- 说明高手可以更快完成

### 3.3 卡池可见性

**矛盾点**：
- 旧文档中未明确说明卡池可见性
- battle.txt 明确为每条音轨展示 1 张，其余 4 张背面

**处理方式**：
- 在相关文档中补充卡池可见性说明

### 3.4 干扰体刷新规则

**矛盾点**：
- 旧文档中未明确说明干扰体刷新规则
- battle.txt 明确为根据玩家实时卡池刷新

**处理方式**：
- 在相关文档中补充干扰体刷新规则说明

---

## 四、补充的核心内容

### 4.1 Boss 战机制

- 补充 Boss 污染卡池增强机制
- 补充 Boss 战设计目的和战斗状态

### 4.2 视觉反馈机制

- 补充段落目标未达成的动画和引导
- 补充超出 4 段红边警报
- 补充超出 6 段视野缩小

### 4.3 奖励机制

- 补充提前结束战斗的额外掉落
- 补充战斗失败条件（8 段后）

### 4.4 流派系统

- 补充流派纯度影响干扰体能力的机制
- 补充高手快速闯关机制

---

## 五、设计理念一致性

所有更新后的文档都遵循以下设计理念：

1. **统一设计理念**：玩家永远在创作，而非纠错
2. **表达导向**：不存在"难听的音乐"，只存在"清晰/不清晰的表达"
3. **战斗结构**：4~8 段，每段 1~3 个回合（根据风格流派不同）
4. **卡池系统**：部分可见，每条音轨展示 1 张
5. **干扰体系统**：根据玩家实时卡池刷新
6. **流派系统**：流派纯度影响干扰体能力

---

## 六、文档使用指南

### 6.1 核心文档

- **Rhythm_Roguelike_Unified_Design_World_Combat_Emotion.md**：统一设计理念（无需更新，仍然有效）
- **Rhythm_Roguelike_Level_Clear_Condition_System.md**：关卡完成条件（无需更新，仍然有效）

### 6.2 已更新文档

- 所有已更新的文档都已与 battle.txt 保持一致
- 所有段数和回合数描述都已统一为 battle.txt 的标准

### 6.3 参考文档

- **Rhythm_Roguelike_Genre_Release_Roadmap_V2.md**：流派发布路线（无需更新，仍然有效）

---

（完）
