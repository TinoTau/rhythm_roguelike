# 🎴 Rhythm Roguelike 卡牌系统设计（V3）
## —— 基于卡池构筑与污染机制的卡牌设计

> 本文档基于 `docs2/battle.txt` 重新设计卡牌系统，  
> 核心机制：**卡池部分可见 + 污染卡牌 + 干扰体消除**

---

## 一、卡牌系统总览

### 1.1 卡池结构

**每局开始时**：
- 玩家获得卡牌池（各音轨 5 张随机卡牌）
- 每条音轨展示 1 张（可见）
- 其余 4 张背面（信息被加密）

**敌人污染卡池**：
- 初始对每条音轨有 4~8 张污染卡
- 与每场战斗的段落数一致

### 1.2 卡牌可见性

**可见卡牌**：
- 每条音轨展示 1 张自己的卡牌

**隐藏卡牌**：
- 其余 4 张自己的卡牌（背面，信息被加密）
- 需要玩家通过手牌估计自己的卡组是什么

**污染卡牌**：
- 来自敌人污染卡池
- 在回合中与玩家卡牌混合出现
- 玩家需要识别哪些是自己的牌，哪些是污染牌

---

## 二、卡牌类型分类

### 2.1 节奏牌和贝斯牌

**定位**：
- 符合基调的节奏牌和贝斯牌
- 用于节奏轨和贝斯轨的自由创作

**获取方式**：
- 有默认库
- 可以通过冒险和探索进行收集

**使用音轨**：
- 节奏轨
- 贝斯轨

**设计特点**：
- 玩家可以自由创作
- 不受风格流派限制（符合基调即可）

---

### 2.2 风格牌和流派牌

**定位**：
- 符合当前音乐类型的风格牌和流派牌
- 用于主音轨和装饰轨的风格表达

**获取方式**：
- **对新玩家全开放，不需要收集**
- 所有风格和流派都可以使用

**使用音轨**：
- **4 轨模式**：主音轨、装饰轨
- **6 轨模式**：主旋律轨、对位/和声轨、节奏化装饰轨、纹理/表情轨
- **注意**：6 轨模式不需要增加新的卡牌类型，所有表达轨都使用相同的卡牌类型，区别在于音乐职责，而非卡牌类型

**设计特点**：
- 决定玩家的风格流派方向
- 影响干扰体的刷新（卡池里的牌有哪些风格和流派，就会刷出对应风格和流派的干扰）

---

### 2.3 音符组合牌 + 音阶牌 + 调性牌

**定位**：
- 用于主音轨和装饰轨的旋律构建
- 构成段落的基本音乐元素

**获取方式**：
- 有默认库
- 可以通过冒险和探索进行收集

**使用音轨**：
- **4 轨模式**：主音轨、装饰轨
- **6 轨模式**：主旋律轨、对位/和声轨、节奏化装饰轨、纹理/表情轨
- **注意**：6 轨模式不需要增加新的卡牌类型，所有表达轨都使用相同的卡牌类型，区别在于音乐职责，而非卡牌类型

**设计特点**：
- 音符组合太明显了，无法干扰（干扰体无法干扰音符组合）
- 音阶和调性可以被干扰体影响

**卡牌类型**：

| 卡牌类型 | 作用 | 可被干扰 |
|---------|------|---------|
| 音符组合牌 | 构成旋律的基本音符组合 | ❌ 无法干扰 |
| 音阶牌 | 决定音阶（如大调、小调、五声音阶等） | ✅ 可被干扰 |
| 调性牌 | 决定调性（如 C 大调、A 小调等） | ✅ 可被干扰 |

---

## 三、卡牌在战斗中的使用

### 3.1 回合中的卡牌选择

**玩家在每条音轨上看到**：
- 1~2 张自己卡池里的牌（可见）
- 污染卡牌（来自敌人污染卡池）
- **总共 5~6 张卡牌**

**玩家需要做**：
- 选择正确的卡牌（污染牌也可以是正确的效果）
- 修复音轨，使当前段落符合乐理

### 3.2 卡牌选择策略

**计算过程**：
1. 通过手牌估计自己的卡组是什么
2. 估计污染卡组是什么
3. 判断干扰体分别造成了哪些干扰
4. 通过计算得出自己当前的风格流派方向是什么
5. 应该排除哪些风格流派，或者顺着哪个风格流派走
6. 或者执意构建自己想象中的流派

**高手策略**：
- 凭着对音乐的理解直接排除干扰和污染
- 快速做出正确判断
- 更快结束段落

**新手策略**：
- 需要多回合来理解卡池和干扰
- 通过试错逐步学习

---

## 四、污染卡牌机制

### 4.1 污染卡牌来源

**敌人污染卡池**：
- 初始对每条音轨有 4~8 张污染卡
- 敌人的技能是用它的卡池污染玩家手牌

### 4.2 污染卡牌识别

**识别难度**：
- 污染卡牌与玩家卡牌混合出现
- 玩家需要识别哪些是自己的牌，哪些是污染牌
- Boss 战时污染增强（每条音轨增加 1/3 的污染牌）

**识别辅助**：
- 可以使用道具标记污染牌
- 可以使用道具看自己的牌

### 4.3 污染卡牌消除

**消除条件**：
- 玩家修复成功时（判断正确）
- 删除敌人污染池里的卡牌（每条音轨各一张）

**消除效果**：
- 污染卡池越来越小
- 玩家能更快做出正确选择结束段落
- 达成通过构筑流派快速结束战斗的效果

---

## 五、卡池构筑系统

### 5.1 战斗后奖励

**敌人掉落**：
- 破损芯片（局内货币）
- 几张卡牌：由玩家 3 选 1 或 5 选 2（根据玩家操作的音轨数量）
- 用于卡池构筑

### 5.2 卡池净化

**净化过程**：
- 随着玩家对自己卡池的构筑，风格流派越来越成熟
- 风格流派越统一，敌人能够造成迷惑的空间越来越小
- 干扰体的干扰能力是随着玩家卡池净化而减少的

**净化效果**：
- 玩家能更快做出正确选择结束段落
- 污染卡池越来越小
- 达成通过构筑流派快速结束战斗的效果

### 5.3 卡池管理（暗网商人）

**删除卡牌**：
- 指定音轨和风格，从卡池里移除
- 不告知具体是哪张
- 用于净化卡池，提升流派纯度

---

## 六、干扰体与卡池的关系

### 6.1 干扰体刷新规则

**刷新逻辑**：
- 根据玩家实时卡池刷新
- 卡池里的牌有哪些风格和流派，就会刷出对应风格和流派的干扰

**刷新时机**：
- 进入下一段落时
- 修复失败时（干扰体全部刷新）

### 6.2 干扰效果

**干扰目标**：
- 使玩家的每条音轨随机发生变化
- 偏离本段应该有的：
  - 节奏
  - 音阶
  - 调性
  - 风格
  - 流派

**无法干扰**：
- 音符组合（太明显了，无法干扰）

### 6.3 干扰体消除

**消除条件**：
- 玩家修复成功时（判断正确）
- 消灭对应的干扰体

**消除效果**：
- 删除敌人污染池里的卡牌（每条音轨各一张）
- 进入下一个段落

---

## 七、卡牌设计原则

### 7.1 可见性设计

**可见卡牌**：
- 每条音轨展示 1 张（让玩家有基础判断）

**隐藏卡牌**：
- 其余 4 张背面（增加策略深度）
- 信息被加密（需要玩家通过手牌估计）

**污染卡牌**：
- 与玩家卡牌混合（增加识别难度）

### 7.2 卡牌设计原则（参考旧版设计）

**设计原则**：
- **指向明确**：每张卡牌的作用清晰，不模糊
- **不兜底整体，只兜底"这一轨"**：卡牌只影响特定音轨，不提供全局保护
- **一句话即可理解效果**：卡牌效果简单明了，不需要复杂解释
- **不永久改变核心规则**：卡牌效果是临时的，不破坏游戏平衡

### 7.2 收集与开放

**需要收集的卡牌**：
- 节奏牌和贝斯牌（有默认库，可收集）
- 音符组合牌 + 音阶牌 + 调性牌（有默认库，可收集）

**全开放的卡牌**：
- 风格牌和流派牌（对新玩家全开放，不需要收集）

### 7.3 干扰与修复

**可被干扰的元素**：
- 节奏
- 音阶
- 调性
- 风格
- 流派

**无法干扰的元素**：
- 音符组合（太明显了，无法干扰）

---

## 八、设计总结

### 8.1 核心机制

1. **卡池部分可见**：增加策略深度，需要玩家通过手牌估计卡组
2. **污染卡牌机制**：增加识别难度，考验玩家对流派的理解
3. **干扰体刷新**：根据玩家卡池刷新，形成动态难度

### 8.2 玩家体验

- **高手**：通过对音乐的理解快速识别污染和干扰，快速完成战斗
- **新手**：通过多回合学习，逐步理解卡池和流派
- **构筑**：通过战斗和商店逐步净化卡池，提升流派纯度

### 8.3 设计目标

> **玩家需要做的是计算：  
> 通过手牌估计自己的卡组、污染卡组、干扰体造成的干扰，  
> 通过计算得出风格流派方向，  
> 最后构筑成功或失败。**

---

（完）
