# 🎴 四音轨制 Roguelike 编曲战斗系统设计文档（进攻 / 防御 / 兜底）

> 本文档回答以下核心问题：
> - Roguelike 部分应设计什么样的卡牌来**增强或兜底单个回合 / 单条音轨的得分**
> - 如何将战斗从「6 回合编曲」重构为「4 条音轨评分 → 攻防结算」
> - 怪物不同行动模式（进攻 / 防御 / 混合）下，如何形成**卡牌对战式编排流程**
> - 每一类卡牌在系统中的职责与设计原则

本文档为 **可实现级系统设计**，可直接作为 GDD 的 Roguelike Combat / Card Design 章节。

---

## 1. 系统总览：四音轨 = 四个结算通道

### 1.1 四音轨定义（冻结）

每一场战斗中，玩家始终维护 **4 条并行循环音轨**：

| 音轨 | 类型 | 战斗映射 |
|---|---|---|
| Track A | 进攻轨 1 | 武器充能 / 主伤害 |
| Track B | 进攻轨 2 | 爆发 / 特效伤害 |
| Track C | 防御轨 1 | 护盾 / 减伤 |
| Track D | 防御轨 2 | 格挡 / 回复 |

> 音轨一旦声明，在整场战斗中持续存在并循环播放。

---

### 1.2 回合制编排与结算节奏

- 每回合：玩家对 **全部或部分音轨** 进行“编排操作”
- 每回合结束：
  - 4 条音轨分别计算**音轨得分**
  - 得分 → 转化为当回合的攻击 / 防御数值

高手：
- 单回合即可把进攻轨拉满 → 秒怪 / 压制

新手：
- 多回合叠加
- 防御不足会承伤

---

## 2. 怪物行动模式 = 对音轨的“强制约束”

怪物不直接“打数值”，而是：
> **规定本回合哪些音轨是“已定的”，哪些必须由玩家编排**。

---

### 2.1 三种基础怪物行动

#### ① 全进攻回合（Pressure Turn）

- 怪物行为：强力攻击
- 系统效果：
  - 进攻轨（A/B）被**固定 Pattern / Accent**
  - 玩家只能操作防御轨（C/D）

玩家体验：
- 被迫防守
- 思考如何用有限资源兜底

---

#### ② 全防御回合（Open Turn）

- 怪物行为：蓄力 / 防御
- 系统效果：
  - 防御轨（C/D）被固定
  - 玩家可自由编排进攻轨（A/B）

玩家体验：
- 输出窗口
- 高风险高收益

---

#### ③ 混合回合（Tactical Turn）

- 系统随机或规则指定：
  - 每条音轨 50% 被固定
  - 剩余部分需玩家填充

玩家体验：
- 最接近“解题”
- 流派与构筑价值最大

---

## 3. Roguelike 卡牌系统的核心目标

> **卡牌的职责不是“加分”，而是：**
> - 提高某条音轨更容易得高分
> - 或在失败时降低该音轨的负面后果

因此，Roguelike 卡牌必须围绕：

1. 音轨偏好
2. 得分放大
3. 得分缓冲
4. 行动约束的对抗

---

## 4. 核心卡牌类型设计（可直接做卡池）

---

### 4.1 音轨强化卡（Track Booster）

**定位**：
- 明确提升某一条音轨的得分效率

**示例**：

- 【攻击轨 A：结构加权】
  - 该轨结构完整度得分 ×1.5

- 【防御轨 C：稳定优先】
  - 该轨一致性得分始终不低于 60%

设计原则：
- 指向明确
- 不兜底整体，只兜底“这一轨”

---

### 4.2 兜底卡（Safety / Insurance）

**定位**：
- 防止单回合崩盘
- 适合新手 / 高压回合

**示例**：

- 【失误吸收】
  - 本回合最低一条音轨得分提升至 50%

- 【护盾缓冲】
  - 防御轨得分低于 40% 时，转化为减伤而非失效

设计原则：
- 不提高上限
- 只抬高下限

---

### 4.3 充能 / 转换卡（Charge & Convert）

**定位**：
- 将一条音轨的成功转移给另一条

**示例**：

- 【节奏转能】
  - 防御轨 C 超过 70% 的得分，20% 转为进攻轨 A 的充能

- 【反击准备】
  - 本回合未使用的防御得分，下回合作为攻击加成

这是高手拉开差距的核心卡型。

---

### 4.4 规则对抗卡（Constraint Breaker）

**定位**：
- 临时对抗怪物的音轨固定规则

**示例**：

- 【自由编排】
  - 本回合可额外修改 1 条被固定的音轨

- 【伪装节奏】
  - 将固定 Pattern 视为合法输入

设计原则：
- 稀有
- 用于关键回合

---

### 4.5 流派协同卡（Archetype Synergy）

**定位**：
- 当你按“正确流派方式”编排时，系统额外奖励

**示例**：

- 【稳定流·进攻回馈】
  - 若两条进攻轨 Pattern 重复 ≥2 回合，伤害翻倍

---

## 5. 单回合卡牌对战流程（完整）

```
① 怪物公开本回合行动模式
② 系统标记被固定 / 可编排的音轨
③ 玩家使用 Roguelike 卡牌（强化 / 兜底 / 对抗）
④ 玩家对可编排音轨进行编曲出牌
⑤ 音乐循环播放并评分
⑥ 4 音轨得分 → 攻击 / 防御结算
```

---

## 6. 得分到战斗结算的映射（示例）

### 6.1 音轨得分计算

- 每条音轨独立评分（0–100）

### 6.2 战斗映射

- 总伤害 = (A + B) × 武器倍率
- 总护盾 = (C + D) × 防御倍率

### 6.3 高手 / 新手分化来源

- 高手：
  - 能在“开放回合”拉满进攻轨
  - 用转换卡滚雪球

- 新手：
  - 依赖兜底卡
  - 多回合消耗

---

## 7. 为什么这是一个“真正的 Roguelike”

- 构筑决定你擅长哪类回合
- 不同怪物 = 不同音轨压制方式
- 每一局编排与解法不同

---

## 8. 最小 Demo 实现清单（MVP）

- 固定 4 条音轨
- 3 种怪物行动模式
- 每类卡牌 3–5 张
- 简化音轨评分（结构 + 一致性）

---

## 9. 从“卡牌”到“回合专属候选池”的玩法升级

### 9.1 回合专属候选池（Phase-based Draft）

在最终设计中，**常规卡牌不再以手牌形式存在**，而是被重构为：

> **每个回合对应一个“编曲问题”，系统从当前候选池中给出 4 个选项，玩家 4 选 1。**

示例：

| 回合 | 编曲阶段 | 4 选 1 内容示例 |
|---|---|---|
| R1 | 节奏 | 拍号 / 步进长度 |
| R2 | 低频 | 贝斯走向 / 和声支撑 |
| R3 | 主音 | 主题动机 / 旋律形态 |
| R4 | 收束 | 修饰 / 终止 / 高光 |

玩家的操作被严格限制为：
- **每回合一次关键选择**
- 不需要管理复杂手牌

---

### 9.2 卡池即构筑（Pool = Build）

Roguelike 的“构筑”不再是拿到什么牌，而是：

- 解锁哪些候选项
- 哪些候选项更容易出现
- 哪些候选项被过滤掉

玩家的直观感受是：
> “这一局后面刷出来的选项，越来越对味。”

---

## 10. 能力系统的最终形态（规则权限）

### 10.1 能力的本质

> **能力不是操作按钮，而是玩家在编曲过程中持续拥有的“规则权限”。**

能力不会参与抽牌，也不会占用回合选择位。

---

### 10.2 能力的来源

- **局外解锁**：
  - 解锁能力方向与模板
  - 代表长期理解成长

- **局内获得**：
  - 在一局中激活 / 强化能力
  - 决定本局流派

---

### 10.3 能力的三种存在形式

1. **被动触发**：条件满足自动生效
2. **回合触发**：每回合可选择是否激活一次
3. **充能释放**：跨回合累积，择机爆发

---

## 11. 融入的核心乐理原理（隐藏规则）

> 玩家不需要理解术语，但系统在持续判断这些结构。

### 11.1 动机（Motif）与回归
- 连续选择风格相近的元素
- 会被系统识别为“主题建立”

### 11.2 张力与释放（Tension & Release）
- 非最优 / 不完全匹配的选择会积累张力
- 张力只在关键回合释放

### 11.3 声部关系（对位 / 支撑 / 冲突）
- 不同音轨之间存在隐性依附或冲突关系

### 11.4 延迟解决与收束（Cadence）
- 前期不爆发
- 在最后回合完成结构性终止

---

## 12. 核心爽点机制：前期平 → 后期收

### 12.1 延迟兑现机制

- 前几回合的选择只给“状态反馈”（稳 / 悬 / 危）
- 不立即给爆发

### 12.2 最终收束节点

- 只有在最后回合
- 才允许：
  - 潜力
  - 张力
  - 动机一致度
  一次性结算

表现为：
- 音乐层数瞬间完整
- 视觉 / 听觉同步爆发
- 敌人血条被“压扁式”结算

---

## 13. UI 与信息呈现原则

### 13.1 三层信息设计

1. **玩家可见**：当前回合任务、4 选 1、音乐状态标签
2. **半可见**：音轨完成度、危险 / 稳定提示
3. **不可见**：潜力、张力、动机一致度

---

### 13.2 UI 核心区域

- 音乐循环可视化区
- 回合选择区（4 选 1）
- 能力面板（常驻显示）

---

## 14. PVP 模式设计要点

### 14.1 核心博弈点

> **PVP 比拼的不是血量，而是谁能成功完成收束。**

- 双方不知道对方的潜力值
- 只能通过选择与听感推测

---

### 14.2 PVP 中能力的价值

- 伪装即将收束的状态
- 干扰或延迟对手收束
- 在非理想条件下强行收束

---

## 15. 多人合作（乐团体验）

- 不同玩家负责不同音轨 / 回合
- 每人只做一次 4 选 1 决策
- 高手通过能力控制整体走向
- 新手不会破坏整体结构

---

## 16. 为什么系统耐玩且不可解

- 没有固定曲目
- 没有唯一最优解
- 爽点集中在“何时结束”

---

## 17. 最终设计宣言

> **本作不是考验你每一步是否最优，
> 而是考验你是否知道：
> 这一刻，该结束了。**

（完）

