# 🎼 Rhythm Roguelike 流派系统设计（V3）
## —— 基于卡池净化与干扰体机制的流派设计

> 本文档基于 `docs2/battle.txt` 重新设计流派系统，  
> 核心机制：**卡池净化 + 流派纯度 + 干扰体刷新**

---

## 一、流派系统总览

### 1.1 流派定义

**流派**：
- 玩家通过卡池构筑形成的风格倾向
- 通过风格牌和流派牌体现
- 影响干扰体的刷新和战斗节奏

### 1.2 流派获取

**风格牌和流派牌**：
- **对新玩家全开放，不需要收集**
- 所有风格和流派都可以使用
- 玩家可以自由选择风格和流派

---

## 二、纯流派 vs 混合流派

### 2.1 纯流派玩法

#### 定义

**纯流派判定条件**：
- ≥70% 段落表达来自同一流派倾向
- 卡池中风格和流派高度统一
- 敌人能够造成迷惑的空间越来越小

**纯流派**：
- 风格流派纯度高
- 卡池中风格和流派高度统一
- 敌人能够造成迷惑的空间越来越小

#### 过关条件

**优势**：
- 干扰体的干扰能力随着玩家卡池净化而减少
- 玩家能更快做出正确选择结束段落
- 污染卡池越来越小
- 达成通过构筑流派快速结束战斗的效果

**奖励**（参考旧版设计）：
- 流派协同倍率提升
- 终结演出稳定性 ↑
- 干扰体干扰能力 ↓
- 战斗节奏更快

**构筑过程**：
- 随着玩家对自己卡池的构筑，风格流派越来越成熟
- 风格流派越统一，敌人能够造成迷惑的空间越来越小
- 干扰体的干扰能力是随着玩家卡池净化而减少的

#### 战斗节奏

- 高手可以在每个回合做出正确判断
- 更快结束段落
- 更快完成战斗

---

### 2.2 混合流派玩法

#### 定义

**混合流派判定条件**：
- 无任何流派占比 ≥60%
- 卡池中包含多种风格和流派
- 风格流派纯度较低
- 敌人能够造成迷惑的空间较大

**混合流派**：
- 卡池中包含多种风格和流派
- 风格流派纯度较低
- 敌人能够造成迷惑的空间较大

#### 过关条件

**特点**：
- 与纯流派相反
- 可能需要更多段落来呈现混合流派的优点
- 高手能否故意制造更多的段落来赢取不一样的奖励？

**风险与收益**（参考旧版设计）：
- **收益**：
  - 表达上限 ↑
  - 卡牌组合可能产生额外协同
  - 观赏性极强
- **风险**：
  - 干扰体更容易制造"失控窗口"
  - 修复失败惩罚 ↑
  - 需要更多段落来呈现混合流派的优点

#### 战斗节奏

- 需要更多段落来呈现混合流派的优点
- 段落增加能否更好地呈现混合流派的优点？

---

## 三、干扰体刷新机制

### 3.1 刷新规则

**刷新逻辑**：
- 根据玩家实时卡池刷新
- **卡池里的牌有哪些风格和流派，就会刷出对应风格和流派的干扰**

**刷新时机**：
- 进入下一段落时
- 修复失败时（干扰体全部刷新）

### 3.2 干扰体类型

**干扰体变种**：
- 可以干扰 1 条或多条音轨
- 造成 1 种或多种干扰
- 数量随难度变化

**干扰效果**：
- 使玩家的每条音轨随机发生变化
- 偏离本段应该有的：
  - 节奏
  - 音阶
  - 调性
  - 风格
  - 流派

### 3.3 干扰体与流派的关系

**纯流派**：
- 卡池中风格和流派高度统一
- 干扰体只能刷出对应风格和流派的干扰
- 玩家容易识别和排除干扰
- 干扰体的干扰能力随着玩家卡池净化而减少

**混合流派**：
- 卡池中包含多种风格和流派
- 干扰体可以刷出多种风格和流派的干扰
- 玩家需要识别和排除多种干扰
- 干扰体的干扰能力较强

---

## 四、卡池净化系统

### 4.1 净化过程

**构筑过程**：
- 随着玩家对自己卡池的构筑，风格流派越来越成熟
- 通过战斗后奖励选择卡牌
- 通过暗网商人删除不需要的卡牌

**净化效果**：
- 风格流派越统一，敌人能够造成迷惑的空间越来越小
- 干扰体的干扰能力是随着玩家卡池净化而减少的
- 玩家能更快做出正确选择结束段落
- 污染卡池越来越小

### 4.2 净化方式

**战斗后奖励**：
- 敌人掉落几张卡牌
- 由玩家 3 选 1 或 5 选 2（根据玩家操作的音轨数量）
- 用于卡池构筑

**暗网商人**：
- 删除自己的牌（指定音轨和风格，从卡池里移除，不告知具体是哪张）
- 用于净化卡池，提升流派纯度

---

## 五、流派与战斗段落

### 5.1 段落数量

**段落范围**：
- 4~8 段乐曲（根据风格流派不同）

**段落特点**：
- 有的可以快速结束（纯流派）
- 有的不能（混合流派可能需要更多段落）

### 5.2 段落与流派的关系

**纯流派**：
- 可以通过快速结束段落完成战斗
- 高手可以在每个回合做出正确判断，更快结束段落

**混合流派**：
- 可能需要更多段落来呈现混合流派的优点
- 段落增加能否更好地呈现混合流派的优点？

### 5.3 段落灵活性

**硬性要求**：
- 一场战斗必须打够 4 个段落是硬性要求

**灵活性**：
- 根据不同的风格流派，4 段不是硬规则
- 但肯定有起承转合的过程
- 让玩家能够看到动画效果，知道自己进行到哪一步了

---

## 六、高手玩法

### 6.1 快速识别

**高手策略**：
- 在风格流派构筑的过程中凭着对音乐的理解直接排除干扰和污染
- 快速闯关
- 这也是游戏本身想要做到的，对乐感的培养

### 6.2 流派理解

**核心能力**：
- 识别哪些是自己的牌，哪些是污染牌
- 即使没抽到想要的牌，打不出想要的效果，也能通过增加段落来完成战斗
- 考验玩家是否真的理解自己正在构筑的流派

### 6.3 故意增加段落

**高手玩法**：
- 高手能否故意制造更多的段落来赢取不一样的奖励？
- 比如在必须使用混合流派的胜利条件下，段落增加能否更好地呈现混合流派的优点？

---

## 七、设计总结

### 7.1 核心机制

1. **流派获取**：风格牌和流派牌全开放，不需要收集
2. **流派构筑**：通过战斗和商店逐步净化卡池，提升流派纯度
3. **干扰体刷新**：根据玩家卡池刷新，形成动态难度

### 7.2 玩家体验

- **纯流派**：通过净化卡池快速完成战斗
- **混合流派**：通过多段落呈现混合流派的优点
- **高手**：通过对音乐的理解快速识别和排除干扰

### 7.3 设计目标

> **随着玩家对自己卡池的构筑，风格流派越来越成熟，  
> 风格流派越统一，敌人能够造成迷惑的空间越来越小，  
> 干扰体的干扰能力是随着玩家卡池净化而减少的，  
> 所以玩家能更快做出正确选择结束段落，  
> 污染卡池越来越小，也就达成了通过构筑流派快速结束战斗的效果。**

---

（完）
